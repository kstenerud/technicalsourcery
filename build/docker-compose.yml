volumes:
  proxy_certs:
  proxy_vhost:
  proxy_html:
  generated_html:

hugo:
  image: jojomi/hugo:latest
  volumes:
    - /home/technicalsourcery/blog:/src
    - generated_html:/output
  environment:
    - HUGO_REFRESH_TIME=3600
    - HUGO_THEME=beg
    - HUGO_BASEURL=technicalsourcery.org
  restart: always

web:
  image: jojomi/nginx-static
  volumes:
    - generated_html:/var/www
  environment:
    - VIRTUAL_HOST=technicalsourcery.org
    # - LETSENCRYPT_HOST=technicalsourcery.org
  ports:
    - 80
  restart: always

proxy:
  image: jwilder/nginx-proxy
  ports:
    - 80:80
    - 443:443
  volumes:
    - /var/run/docker.sock:/tmp/docker.sock
    - proxy_certs:/etc/nginx/certs
    - proxy_vhosts:/etc/nginx/vhost.d
    - proxy_html:/usr/share/nginx/html
  restart: always

ssl:
  image: jrcs/letsencrypt-nginx-proxy-companion
  volumes:
    - /var/run/docker.sock:/tmp/docker.sock
    - proxy_certs:/etc/nginx/certs
    - proxy_vhost:/etc/nginx/vhost.d
    - proxy_html:/usr/share/nginx/html
  restart: always
